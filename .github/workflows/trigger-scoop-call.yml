name: Update Scoop Bucket

on:
  workflow_run:
    workflows: ['Build and Release']
    types:
      - completed

jobs:
  update-scoop:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    uses: ropean/scoop-ropean/.github/workflows/update-scoop-call.yml@main
    with:
      tag: ${{ github.event.workflow_run.head_branch }}

      app_name: 'c-hash'
      exe_name: 'c-hash.exe'

      source_repo: ${{ github.repository }}

      description: 'Windows C++ GUI hasher'
      homepage: 'https://github.com/ropean/c-hash/'
      license_identifier: 'MIT'
      license_url: 'https://github.com/ropean/c-hash/blob/main/LICENSE'

      shortcut_name: 'C Hash'
      shortcut_description: 'File hashing utility'

      notes: 'Windows C++ GUI hasher, computes SHA-256 via Windows CNG with streamed I/O and a minimal Win32 UI.'

    secrets:
      source_repo_token: ${{ secrets.GITHUB_TOKEN }}
      deploy_key: ${{ secrets.SCOOP_ROPEAN_DEPLOY_KEY }}
